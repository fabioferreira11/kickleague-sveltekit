import{s as fe,b as D,e as S,t as te,j as B,d as j,p as de,f as T,h as oe,i as m,q as _,y as V,k as O,l as w,v as pe,m as me,B as he,C as ye,D as se}from"../chunks/scheduler.RIs2sDzR.js";import{S as _e,i as ge,a as I,c as ne,t as L,b as F,d as U,m as J,e as G,g as le}from"../chunks/index.CgKjrO5Z.js";import{e as ae,u as be,o as we}from"../chunks/each.NZ2UQc-u.js";/* empty css                       */import{H as ve,M as ke}from"../chunks/MenuBurger.CLckUUVR.js";import{C as Se}from"../chunks/carte-joueur.BWiSuAb-.js";async function je(n){console.log("Attempting to load players for userId:",n);const o=await(await fetch("/api/checkIfPackOpened",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n})})).json();if(console.log("Pack opened data:",o),o.opened){let a=await(await fetch("/api/getUserPlayers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n})})).json();return console.log("Loaded players:",a),a=a.map((r,f)=>({...r,order:f})),a}else return console.log("Pack not opened for userId:",n),[]}function re(n,t,o){const e=n.slice();return e[13]=t[o],e}function Ce(n){let t,o;return t=new ve({props:{style:"margin-top: 2vh;"}}),{c(){F(t.$$.fragment)},l(e){U(t.$$.fragment,e)},m(e,a){J(t,e,a),o=!0},i(e){o||(L(t.$$.fragment,e),o=!0)},o(e){I(t.$$.fragment,e),o=!1},d(e){G(t,e)}}}function Ee(n){let t,o;return t=new ke({}),{c(){F(t.$$.fragment)},l(e){U(t.$$.fragment,e)},m(e,a){J(t,e,a),o=!0},i(e){o||(L(t.$$.fragment,e),o=!0)},o(e){I(t.$$.fragment,e),o=!1},d(e){G(t,e)}}}function ie(n,t){let o,e,a;return e=new Se({props:{player:t[13],fullWidth:!1}}),{key:n,first:null,c(){o=se(),F(e.$$.fragment),this.h()},l(r){o=se(),U(e.$$.fragment,r),this.h()},h(){this.first=o},m(r,f){O(r,o,f),J(e,r,f),a=!0},p(r,f){t=r;const c={};f&4&&(c.player=t[13]),e.$set(c)},i(r){a||(L(e.$$.fragment,r),a=!0)},o(r){I(e.$$.fragment,r),a=!1},d(r){r&&m(o),G(e,r)}}}function Te(n){let t,o,e,a,r='<h2 class="svelte-l3jwwb">Club</h2> <p class="svelte-l3jwwb">Bienvenue dans votre club, où toutes vos cartes sont à portée de main. Filtrer facilement vos cartes par équipe, rareté ou anciénneté pour visualiser les différentes cartes que vous possédez.</p>',f,c,h,g,P,k,q,N,d,y,i,b,A,v,R,C,p=[],K=new Map,E,W,Q;const X=[Ee,Ce],$=[];function Y(s,l){return s[0]?0:1}t=Y(n),o=$[t]=X[t](n);let M=ae(n[2]);const Z=s=>s[13].id;for(let s=0;s<M.length;s+=1){let l=re(n,M,s),u=Z(l);K.set(u,p[s]=ie(u,l))}return{c(){o.c(),e=D(),a=S("section"),a.innerHTML=r,f=D(),c=S("div"),h=S("div"),g=S("button"),P=te("Équipe "),k=S("div"),N=D(),d=S("div"),y=D(),i=S("button"),b=te(n[4]),A=D(),v=S("div"),R=D(),C=S("section");for(let s=0;s<p.length;s+=1)p[s].c();this.h()},l(s){o.l(s),e=B(s),a=j(s,"SECTION",{class:!0,"data-svelte-h":!0}),de(a)!=="svelte-2jkbz9"&&(a.innerHTML=r),f=B(s),c=j(s,"DIV",{id:!0,class:!0});var l=T(c);h=j(l,"DIV",{class:!0});var u=T(h);g=j(u,"BUTTON",{id:!0,class:!0});var H=T(g);P=oe(H,"Équipe "),k=j(H,"DIV",{class:!0}),T(k).forEach(m),H.forEach(m),N=B(u),d=j(u,"DIV",{class:!0,"data-filter-group":!0}),T(d).forEach(m),u.forEach(m),y=B(l),i=j(l,"BUTTON",{class:!0});var z=T(i);b=oe(z,n[4]),A=B(z),v=j(z,"DIV",{class:!0}),T(v).forEach(m),z.forEach(m),l.forEach(m),R=B(s),C=j(s,"SECTION",{class:!0});var ee=T(C);for(let x=0;x<p.length;x+=1)p[x].l(ee);ee.forEach(m),this.h()},h(){_(a,"class","club-text svelte-l3jwwb"),_(k,"class","fleche svelte-l3jwwb"),V(k,"bas",n[1]),_(g,"id","filter-team"),_(g,"class",q="btn-filtre "+(n[1]?"open":"")+" svelte-l3jwwb"),_(d,"class","filter-options svelte-l3jwwb"),_(d,"data-filter-group","team"),_(h,"class","filter-dropdown svelte-l3jwwb"),_(v,"class","fleche svelte-l3jwwb"),V(v,"bas",!n[3]),_(i,"class","btn-filtre svelte-l3jwwb"),_(c,"id","filters"),_(c,"class","svelte-l3jwwb"),_(C,"class","carte-club svelte-l3jwwb")},m(s,l){$[t].m(s,l),O(s,e,l),O(s,a,l),O(s,f,l),O(s,c,l),w(c,h),w(h,g),w(g,P),w(g,k),w(h,N),w(h,d),w(c,y),w(c,i),w(i,b),w(i,A),w(i,v),O(s,R,l),O(s,C,l);for(let u=0;u<p.length;u+=1)p[u]&&p[u].m(C,null);E=!0,W||(Q=pe(i,"click",n[5]),W=!0)},p(s,[l]){let u=t;t=Y(s),t!==u&&(le(),I($[u],1,1,()=>{$[u]=null}),ne(),o=$[t],o||(o=$[t]=X[t](s),o.c()),L(o,1),o.m(e.parentNode,e)),(!E||l&2)&&V(k,"bas",s[1]),(!E||l&2&&q!==(q="btn-filtre "+(s[1]?"open":"")+" svelte-l3jwwb"))&&_(g,"class",q),(!E||l&16)&&me(b,s[4]),(!E||l&8)&&V(v,"bas",!s[3]),l&4&&(M=ae(s[2]),le(),p=be(p,l,Z,1,s,M,K,C,we,ie,null,re),ne())},i(s){if(!E){L(o);for(let l=0;l<M.length;l+=1)L(p[l]);E=!0}},o(s){I(o);for(let l=0;l<p.length;l+=1)I(p[l]);E=!1},d(s){s&&(m(e),m(a),m(f),m(c),m(R),m(C)),$[t].d(s);for(let l=0;l<p.length;l+=1)p[l].d();W=!1,Q()}}}function Pe(){const n=document.getElementById("filter-team"),t=document.querySelector('[data-filter-group="team"]');t.offsetWidth>n.offsetWidth&&(n.style.width=`${t.offsetWidth}px`)}function $e(){document.querySelectorAll(".carte-joueur").forEach(t=>{console.log(t.dataset.team)})}function ce(n){n.style.backgroundColor="var(--white)",n.style.padding="1vh 2vw",n.style.color="var(--green)",n.style.border="0",n.style.fontSize="var(--text)"}function ue(){const n=new Set(Array.from(document.querySelectorAll(".carte-joueur")).map(e=>e.dataset.team)),t=document.querySelector('[data-filter-group="team"]');t.innerHTML="";const o=document.createElement("button");o.textContent="Tous",o.setAttribute("data-filter","*"),ce(o),t.appendChild(o),n.forEach(e=>{const a=document.createElement("button");a.textContent=e,a.setAttribute("data-filter",e),ce(a),t.appendChild(a)})}function Oe(n,t,o){let e=!1,a=!1,r=[],f,c=!0,h=!0,g="ASC";function P(){typeof window<"u"&&o(0,e=window.innerWidth<=768)}he(async()=>{const d=await fetch("/api/session",{method:"GET",credentials:"include"}),y=await d.json();if(console.log("Session Data:",y),d.ok){f=y.userid;const b=await(await fetch("/api/getPlayerPack",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:f})})).json();console.log("getPlayerPack Response:",b),o(2,r=await je(f)),console.log("Loaded Players :",r),ue(),$e()}typeof window<"u"&&(P(),window.addEventListener("resize",P),document.querySelectorAll(".filter-dropdown button").forEach(i=>{i.addEventListener("click",function(){const b=this.nextElementSibling;b.style.display=b.style.display==="block"?"none":"block",this.id==="filter-team"&&ue(),o(1,a=!a),a&&Pe()})}),document.querySelector('[data-filter-group="team"]').addEventListener("click",i=>{i.target.tagName==="BUTTON"&&k(i.target)}))}),ye(()=>{typeof window<"u"&&window.removeEventListener("resize",P)});function k(d){const y=d.getAttribute("data-filter"),i=document.getElementById("filter-team"),b=document.querySelector('[data-filter-group="team"]'),A=i.querySelector(".fleche");document.querySelectorAll(".carte-joueur").forEach(v=>{v.style.display=y==="*"||v.dataset.team===y?"flex":"none"}),i.textContent=y==="*"?"Équipe":d.textContent,i.appendChild(A),b.style.display="none",o(1,a=!1),A.classList.remove("bas")}function q(){c=!c,o(2,r=r.sort((d,y)=>c?d.order-y.order:y.order-d.order))}function N(){o(3,h=!h),o(4,g=h?"ASC":"DSC"),q()}return[e,a,r,h,g,N]}class Ne extends _e{constructor(t){super(),ge(this,t,Oe,Te,fe,{})}}export{Ne as component};
